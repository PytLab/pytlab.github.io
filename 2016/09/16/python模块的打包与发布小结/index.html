<!DOCTYPE HTML>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>python模块的打包与发布小结 | PytLab</title>
  <meta name="author" content="PytLab">
  
  <meta name="description" content="Personal Blog of ShaoZhengjiang">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="python模块的打包与发布小结"/>
  <meta property="og:site_name" content="PytLab"/>

  
    <meta property="og:image" content="undefined"/>
  

  
  
    <link href="/assets/images/favicon/icon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/bootstrap.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-73223373-1', 'auto');
  ga('send', 'pageview');
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->




</head>

 <body>  
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><nav id="main-nav" class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/"></a>
      <div class="collapse navbar-collapse nav-menu">
		    <ul class="nav navbar-nav">
		      

          <!-- Categories -->
          
          <li>
            <a href="/" title="PytLab's Home" style="font-weight: normal; font-family: Calibri,Arial; font-size: 18px">
              <i class="fa fa-bank"></i>Home
            </a>
          </li>
          
		      

          <!-- Categories -->
          
          <!-- Archives -->
          <li class="dropdown">
            <a href="/archives" class="dropdown-toggle" data-toggle="dropdown" title="All the articles." style="font-weight: normal; font-family: Calibri,Arial; font-size:     18px">
            <i class="fa fa-archive"></i>Archives
            <b class="caret"></b>   
            </a>
            <ul class="dropdown-menu">
              <li class="divider"></li>
              <li><a href="/archives" style="font-size: 20px; font-family: 'Calibri Light',Arial">All Archives</a><span></span></li>
              <li class="divider"></li>
              
              <li><a href="/2017/03/26/优雅的在终端中编写Python/" style="font-size: 15px; font-family: 微软雅黑">优雅的在终端中编写Python<span></span></a></li>
              
              <li><a href="/2017/02/19/Python多进程并行编程实践-mpi4py的使用/" style="font-size: 15px; font-family: 微软雅黑">Python多进程并行编程实践-mpi4py的使用<span></span></a></li>
              
              <li><a href="/2017/02/16/一本不错的MPI教程/" style="font-size: 15px; font-family: 微软雅黑">推荐一本不错的MPI教程<span></span></a></li>
              
              <li><a href="/2017/02/14/ECMAScript中的作用域链和闭包/" style="font-size: 15px; font-family: 微软雅黑">ECMAScript中的作用域链和闭包<span></span></a></li>
              
              <li><a href="/2017/02/08/ECMAScript中的OOP-继承/" style="font-size: 15px; font-family: 微软雅黑">ECMAScript中的OOP-继承<span></span></a></li>
              
              <li><a href="/2017/02/06/ECMAScript中的OOP-创建对象/" style="font-size: 15px; font-family: 微软雅黑">ECMAScript中的OOP-对象创建<span></span></a></li>
              
              <li><a href="/2017/02/05/ECMAScript对象属性小结/" style="font-size: 15px; font-family: 微软雅黑">ECMAScript对象属性小结<span></span></a></li>
              
              <li class="divider"></li>
            </ul>
          </li>

          
		      

          <!-- Categories -->
          
		      <li class="dropdown">
            <a href="/categories" class="dropdown-toggle" data-toggle="dropdown" title="All the categories." style="font-weight: normal; font-family: Calibri,Arial; font-size:     18px">
		    	  <i class="fa fa-folder"></i>Categories
            <b class="caret"></b>   
		    	  </a>
            <ul class="dropdown-menu">
              <li class="divider"></li>
              <li><a href="/categories" style="font-size: 20px; font-family: 'Calibri Light',Arial">All Categories</a><span></span></li>
              <li class="divider"></li>
              
              <li><a href="/categories/学习小结/" style="font-size: 15px; font-family: 微软雅黑">学习小结<span></span></a></li>
              
              <li><a href="/categories/学术/" style="font-size: 15px; font-family: 微软雅黑">学术<span></span></a></li>
              
              <li><a href="/categories/代码作品/" style="font-size: 15px; font-family: 微软雅黑">代码作品<span></span></a></li>
              
              <li><a href="/categories/教程/" style="font-size: 15px; font-family: 微软雅黑">教程<span></span></a></li>
              
              <li><a href="/categories/我的日常/" style="font-size: 15px; font-family: 微软雅黑">我的日常<span></span></a></li>
              
              <li><a href="/categories/工具应用/" style="font-size: 15px; font-family: 微软雅黑">工具应用<span></span></a></li>
              
              <li><a href="/categories/随笔/" style="font-size: 15px; font-family: 微软雅黑">随笔<span></span></a></li>
              
              <li class="divider"></li>
            </ul>
		      </li>

          
		      

          <!-- Categories -->
          
          <!-- Tags -->
          <li class="dropdown">
            <a href="/tags" class="dropdown-toggle" data-toggle="dropdown" title="All the tags." style="font-weight: normal; font-family: Calibri,Arial; font-size:     18px">
            <i class="fa fa-tags"></i>Tags
            <b class="caret"></b>   
            </a>
            <ul class="dropdown-menu">
              <li class="divider"></li>
              <li><a href="/tags" style="font-size: 20px; font-family: 'Calibri Light',Arial">All Tags</a><span></span></li>
              <li class="divider"></li>
              
              <li><a href="/tags/Cpp/" style="font-size: 15px; font-family: 微软雅黑">Cpp<span></span></a></li>
              
              <li><a href="/tags/python/" style="font-size: 15px; font-family: 微软雅黑">python<span></span></a></li>
              
              <li><a href="/tags/catalysis/" style="font-size: 15px; font-family: 微软雅黑">catalysis<span></span></a></li>
              
              <li><a href="/tags/C/" style="font-size: 15px; font-family: 微软雅黑">C<span></span></a></li>
              
              <li><a href="/tags/chemistry/" style="font-size: 15px; font-family: 微软雅黑">chemistry<span></span></a></li>
              
              <li><a href="/tags/Parallel-Computing/" style="font-size: 15px; font-family: 微软雅黑">Parallel Computing<span></span></a></li>
              
              <li><a href="/tags/学术/" style="font-size: 15px; font-family: 微软雅黑">学术<span></span></a></li>
              
              <li class="divider"></li>
            </ul>
          </li>
          
          
		      

          <!-- Categories -->
          
          <li>
            <a href="/about" title="About me." style="font-weight: normal; font-family: Calibri,Arial; font-size: 18px">
              <i class="fa fa-user"></i>About
            </a>
          </li>
          
		      
		    </ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">		
			<h1> python模块的打包与发布小结</h1>
		</div>		
	



<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>昨天把自己的VASP文件处理库进行了打包并上传到PyPI，现在可以直接通过<code>pip</code>和<code>easy_install</code>来安装VASPy啦，</p>
<ul>
<li>VASPy的GotHub地址：<a href="https://github.com/PytLab/VASPy" target="_blank" rel="external">https://github.com/PytLab/VASPy</a></li>
<li>VASPy的PyPI地址：<a href="https://pypi.python.org/pypi/vaspy/" target="_blank" rel="external">https://pypi.python.org/pypi/vaspy/</a></li>
</ul>
<p>由于自己的记性真是不咋地，怕时间久了就忘了，于是在这里趁热打铁以自己的VASPy程序为例对python的打包和上传进行下总结。</p>
<a id="more"></a>
<h2 id="VASPy包文件结构"><a href="#VASPy包文件结构" class="headerlink" title="VASPy包文件结构"></a>VASPy包文件结构</h2><p>首先写贴上来VASPy包的整个文件结构, 后面的内容都是以此为例进行说明：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">VASPy/</div><div class="line">├── LICENSE</div><div class="line">├── MANIFEST</div><div class="line">├── MANIFEST<span class="selector-class">.in</span></div><div class="line">├── README<span class="selector-class">.rst</span></div><div class="line">├── requirements<span class="selector-class">.txt</span></div><div class="line">├── scripts</div><div class="line">│   ├── change_incar_parameters<span class="selector-class">.py</span></div><div class="line">│   ├── create_inputs<span class="selector-class">.py</span></div><div class="line">│   └── ...</div><div class="line">├── setup<span class="selector-class">.cfg</span></div><div class="line">├── setup<span class="selector-class">.py</span></div><div class="line">├── tests</div><div class="line">│   ├── incar_test<span class="selector-class">.py</span></div><div class="line">│   ├── __init__<span class="selector-class">.py</span></div><div class="line">│   ├── oszicar_test<span class="selector-class">.py</span></div><div class="line">│   ├── outcar_test<span class="selector-class">.py</span></div><div class="line">│   ├── testdata</div><div class="line">│   │   ├── CONTCAR</div><div class="line">│   │   ├── DOS_SUM</div><div class="line">│   │   ├── ELFCAR</div><div class="line">│   │   └── ...</div><div class="line">│   └── ...</div><div class="line">└── vaspy</div><div class="line">    ├── __init__<span class="selector-class">.py</span></div><div class="line">    ├── iter<span class="selector-class">.py</span></div><div class="line">    ├── matstudio<span class="selector-class">.py</span></div><div class="line">    └── ...</div><div class="line"></div><div class="line"><span class="number">4</span> directories, <span class="number">54</span> files</div></pre></td></tr></table></figure>
<h2 id="打包和安装第三方包的工具"><a href="#打包和安装第三方包的工具" class="headerlink" title="打包和安装第三方包的工具"></a>打包和安装第三方包的工具</h2><ul>
<li><p>这里我们需要借助<code>setuptools</code>和<code>pip</code>等工具进行自己包的打包和发布以及安装，如果需要构建成wheel还需要安装<code>wheel</code>模块。如果python版本&gt;=2.7.9或者&gt;=3.4，setuptools和pip是已经安装好的，可能需要进行更新到最新版本。</p>
  <figure class="highlight cmake"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip <span class="keyword">install</span> -U pip setuptools</div></pre></td></tr></table></figure>
</li>
<li><p>可以使用包管理工具，例如</p>
  <figure class="highlight cmake"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum <span class="keyword">install</span> pip</div></pre></td></tr></table></figure>
  <figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-<span class="keyword">get</span> install pip</div></pre></td></tr></table></figure>
</li>
<li><p>通过<code>get-pip.py</code>脚本安装，如果检测到没有安装<code>wheel</code>和<code>setuptools</code>也会自动安装。</p>
  <figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">python</span> <span class="built_in">get</span>-pip.<span class="keyword">py</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>具体的工具安装和介绍就不多讲了，可以请参考<a href="https://packaging.python.org/installing/#installing-requirements" target="_blank" rel="external">requirements for installing packages</a></p>
<h2 id="包中不同文件的作用"><a href="#包中不同文件的作用" class="headerlink" title="包中不同文件的作用"></a>包中不同文件的作用</h2><h3 id="setup-py"><a href="#setup-py" class="headerlink" title="setup.py"></a><code>setup.py</code></h3><p>这个文件是打包整个项目最重要的文件，它里面提供了两个主要的功能：</p>
<ol>
<li><code>setup()</code>函数，此函数的参数指定了如何配置自己的项目。</li>
<li>命令行工具，包括打包，测试，发布等。可以通过下面的命令查看； <figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">python</span> setup.<span class="keyword">py</span> --<span class="keyword">help</span>-commands</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="setup-cfg"><a href="#setup-cfg" class="headerlink" title="setup.cfg"></a><code>setup.cfg</code></h3><p>此文件包含了构建时候的一些默认参数例如构建<code>bdist_wheel</code>的时候的<code>--universal</code>参数<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="section">[bdist_wheel]</span></div><div class="line"><span class="attr">universal</span>=<span class="number">1</span></div></pre></td></tr></table></figure></p>
<p>这样每次打包的时候就会默认使用<code>--universal</code>参数了，效果类似：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python setup<span class="selector-class">.py</span> bdist_wheel --universal</div></pre></td></tr></table></figure></p>
<h3 id="README-rst"><a href="#README-rst" class="headerlink" title="README.rst"></a><code>README.rst</code></h3><p>这个最初我是用markdown写的，打包发布到PyPI之后发现PyPI不支持markdown的渲染，页面上真是一片混乱，于是就用reStrutruedText的语法重新写了一遍。毕竟标记语言语法基本上可以秒上手，实在不行找个模板比葫芦画瓢就行。<br>reStructureText的语法规则可参考官方文档:<a href="http://docutils.sourceforge.net/docs/user/rst/quickref.html" target="_blank" rel="external">Quick <em>re</em>Structured<em>Text</em></a></p>
<p>其实还有一种方法就是使用pandoc将markdown转换成rst格式，一种省事的方式就是使用<code>pyandoc</code>模块在发布的时候自动转换。<br>具体方法可以参考：<a href="https://coderwall.com/p/qawuyq/use-markdown-readme-s-in-python-modules" target="_blank" rel="external">Use Markdown README’s in Python modules</a></p>
<h3 id="MANIFEST-in"><a href="#MANIFEST-in" class="headerlink" title="MANIFEST.in"></a><code>MANIFEST.in</code></h3><p>此文件在打包的时候告诉setuptools还需要额外打包那些文件，例如我VASPy中的单元测试的测试数据文件我就使用这个文件将其包含进来。当然README，LICENSE这些也可以通过它来一起打包进来。<br>下面是我自己的<code>MANIFEST.in</code>的内容：<br><figure class="highlight fortran"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">include</span> README.rst</div><div class="line"><span class="keyword">include</span> requirements.txt</div><div class="line"><span class="keyword">include</span> LICENSE</div><div class="line"><span class="keyword">recursive</span>-<span class="keyword">include</span> scripts *</div><div class="line"><span class="keyword">recursive</span>-<span class="keyword">include</span> tests *</div></pre></td></tr></table></figure></p>
<p>具体的语法规则可以参考：<a href="https://docs.python.org/2/distutils/sourcedist.html#the-manifest-in-template" target="_blank" rel="external">The MANIFEST.in template</a></p>
<h3 id="vaspy"><a href="#vaspy" class="headerlink" title="vaspy/"></a><code>vaspy/</code></h3><p>此文件夹就是vaspy源代码所在的包。</p>
<h3 id="tests"><a href="#tests" class="headerlink" title="tests/"></a><code>tests/</code></h3><p>此文件夹也是一个子包，包含了单元测试脚本，为了能使用<code>python setup.py test</code>进行单元测试，特地添加了<code>__init__.py</code>s使其成为一个包。</p>
<h2 id="setup-的参数"><a href="#setup-的参数" class="headerlink" title="setup()的参数"></a><code>setup()</code>的参数</h2><p>这里只介绍我使用的几个参数，其他参数的具体使用可以参考：<a href="https://docs.python.org/3/distutils/setupscript.html" target="_blank" rel="external">https://docs.python.org/3/distutils/setupscript.html</a></p>
<h3 id="name"><a href="#name" class="headerlink" title="name"></a>name</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attr">versions</span> = <span class="string">"vaspy"</span></div></pre></td></tr></table></figure>
<p>是整个项目的名字，打包后会使用此名字和版本号。</p>
<h3 id="version"><a href="#version" class="headerlink" title="version"></a>version</h3><figure class="highlight sqf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> vaspy import <span class="variable">__version__</span></div><div class="line">version = <span class="variable">__version__</span></div></pre></td></tr></table></figure>
<h3 id="description"><a href="#description" class="headerlink" title="description"></a>description</h3><p>是一个简短的对项目的描述，一般一句话就好，会显示在pypi上名字下端。</p>
<h3 id="long-description"><a href="#long-description" class="headerlink" title="long_description"></a>long_description</h3><p>是一个长的描述，相当于对项目的一个简洁，如果此字符串是<code>rst</code>格式的，PyPI会自动渲染成HTML显示。这里可以直接读取<code>README.rst</code>中的内容。</p>
<h3 id="url"><a href="#url" class="headerlink" title="url"></a>url</h3><p>包的连接，通常为GitHub上的链接或者readthedocs的链接。</p>
<h3 id="packages"><a href="#packages" class="headerlink" title="packages"></a>packages</h3><p>需要包含的子包列表，setuptools提供了<code>find_packages()</code>帮助我们在根路径下寻找包，这个函数distutil是没有的。</p>
<h3 id="setup-requires"><a href="#setup-requires" class="headerlink" title="setup_requires"></a>setup_requires</h3><p>这个参数定义了VASPy安装和顺利运行所需要的其他依赖项（最基本的），使用pip安装的时候会对这些依赖项进行安装。<br>关于这个参数与requirements.txt的区别可以参考：<a href="https://packaging.python.org/requirements/#install-requires-vs-requirements-files" target="_blank" rel="external">install_requires vs Requirements files</a></p>
<h3 id="classifier"><a href="#classifier" class="headerlink" title="classifier"></a>classifier</h3><p>这个参数提供了一系列的分类，在PyPI上会将其放入不同的目录中讲项目进行归类。<br>具体的categories的名称和规则参考：<a href="https://pypi.python.org/pypi?%3Aaction=list_classifiers" target="_blank" rel="external">https://pypi.python.org/pypi?%3Aaction=list_classifiers</a></p>
<h3 id="test-suite"><a href="#test-suite" class="headerlink" title="test_suite"></a>test_suite</h3><p>这个参数可以帮助我们使用<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python setup<span class="selector-class">.py</span> test</div></pre></td></tr></table></figure></p>
<p>来跑单元测试，再也不需要单独再写一个脚本例如<code>run_tests.py</code>这样来跑单元测试了。<br>此参数的官方解释：</p>
<blockquote>
<p>A string naming a unittest.TestCase subclass (or a package or module containing one or more of them, or a method of such a subclass), or naming a function that can be called with no arguments and returns a unittest.TestSuite. If the named suite is a module, and the module has an additional_tests() function, it is called and the results are added to the tests to be run. If the named suite is a package, any submodules and subpackages are recursively added to the overall test suite.</p>
</blockquote>
<p>也就是说这个参数可以接受多种类型的参数：</p>
<ol>
<li>接收<code>unittest.TestCase</code>子类，我们可以讲所有单元测试写入一个测试用例中，然后import进来，再传你给<code>test_suite</code></li>
<li>接收函数对象，此函数对象没有任何参数，且返回一个<code>unittest.TestSuite</code>.这样我们就可以单独写一个函数，将多个测试用例合并成一个suite然后返回，然后再将函数import进来传给<code>test_suite</code>。</li>
<li>模块和包名称，我就是使用这种方式，之前自己的测试都是分开的多个脚本，这样我添加一个<code>__init__.py</code>就可以将其变成一个包，将包名传给<code>test_suite</code>，setuptools就会神奇的将此包下的所有测试全部跑一边，这样我以后再加测试脚本的时候直接就添加新的脚本就好了，其他的都不需要改动了。<br> 运行效果： <figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">zjshao@SHAO-PC:/mnt/d/Dropbox/Code/CentOS_code/VASPy$ python setup.py test</div><div class="line">running test</div><div class="line">running egg_info</div><div class="line">creating vaspy.egg-info</div><div class="line">writing vaspy.egg-info/PKG-INFO</div><div class="line">writing top-level names <span class="built_in">to</span> vaspy.egg-info/top_level.txt</div><div class="line">writing dependency_links <span class="built_in">to</span> vaspy.egg-info/dependency_links.txt</div><div class="line">writing manifest <span class="built_in">file</span> <span class="string">'vaspy.egg-info/SOURCES.txt'</span></div><div class="line">reading manifest <span class="built_in">file</span> <span class="string">'vaspy.egg-info/SOURCES.txt'</span></div><div class="line">reading manifest template <span class="string">'MANIFEST.in'</span></div><div class="line">writing manifest <span class="built_in">file</span> <span class="string">'vaspy.egg-info/SOURCES.txt'</span></div><div class="line">running build_ext</div><div class="line">test_compare (tests.incar_test.InCarTest)</div><div class="line">Make sure we can compare <span class="literal">two</span> InCar objects correctly. ... ok</div><div class="line">test_eq (tests.incar_test.InCarTest)</div><div class="line">Test __eq__() <span class="function"><span class="keyword">function</span>. ... <span class="title">ok</span></span></div><div class="line">...</div><div class="line">此处省略若干输出</div><div class="line"></div><div class="line"><span class="comment">----------------------------------------------------------------------</span></div><div class="line">Ran <span class="number">22</span> tests <span class="keyword">in</span> <span class="number">3.574</span>s</div><div class="line"></div><div class="line">OK</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="发布自己的python包"><a href="#发布自己的python包" class="headerlink" title="发布自己的python包"></a>发布自己的python包</h2><ol>
<li><p>首先先去PyPI注册帐号</p>
</li>
<li><p>配置<code>~/.pypirc</code>如下：</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">[distutils]</div><div class="line">index-servers =</div><div class="line">    pypi</div><div class="line">    pypitest</div><div class="line"></div><div class="line">[pypi]</div><div class="line">username:ShaoZhengjiang</div><div class="line">password:mypassword</div><div class="line"></div><div class="line">[pypitest]</div><div class="line">username:ShaoZhengjiang</div><div class="line">password:mypassword</div></pre></td></tr></table></figure>
</li>
<li><p>然后注册并上传自己的包到测试服务器<br> pypi提供了一个测试服务器，我们可以在这个测试服务器上做测试。</p>
 <figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python <span class="built_in">setup</span>.py <span class="keyword">register</span> -r pypitest</div></pre></td></tr></table></figure>
<p> 然后</p>
 <figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python setup<span class="selector-class">.py</span> sdist upload -r pypitest</div></pre></td></tr></table></figure>
<p> 若没有问题我们应该不会得到任何错误。</p>
</li>
<li><p>上传至PyPI<br> 若上面的测试成功，我们就可以按照相同的步骤将包注册并上传。</p>
 <figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python <span class="built_in">setup</span>.py <span class="keyword">register</span> -r pypi</div></pre></td></tr></table></figure>
 <figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python setup<span class="selector-class">.py</span> sdist upload -r pypi</div></pre></td></tr></table></figure>
</li>
</ol>
<p>Ok,之后我们就可以在PyPI上看到我们自己的包了。(<a href="https://pypi.python.org/pypi/vaspy/" target="_blank" rel="external">https://pypi.python.org/pypi/vaspy/</a>)</p>
<p><img src="/assets/images/blog_img/2016-09-16-python模块的打包与发布小结/vaspy_pypi.png" alt=""></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="https://coderwall.com/p/qawuyq/use-markdown-readme-s-in-python-modules" target="_blank" rel="external">Use Markdown README’s in Python modules</a></li>
<li><a href="https://packaging.python.org/distributing/#package-data" target="_blank" rel="external">Packaging and Distributing Projects</a></li>
<li><a href="http://stackoverflow.com/questions/50499/how-do-i-get-the-path-and-name-of-the-file-that-is-currently-executing" target="_blank" rel="external">How do I get the path and name of the file that is currently executing?</a></li>
<li><a href="http://peterdowns.com/posts/first-time-with-pypi.html" target="_blank" rel="external">How to submit a package to PyPI</a></li>
</ul>
	  
	</div>

    
	<div>
  	<center>
	<div class="pagination">
<ul class="pagination">
	 
				
    	<li class="prev"><a href="/2016/10/20/C-的delegation-constructor/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>Prev</a></li>
  		

        <li><a href="/"><i class="fa fa-archive"></i>Archive</a></li>

		
		   <li class="next"><a href="/2016/09/13/难忘的pycon-china-2016/" class="alignright next">Next<i class="fa fa-arrow-circle-o-right"></i></a></li>         
        
	
</ul>
</div>

    </center>
	</div>
    
	
    <!-- bdshare -->
    
        
    <div class="bdsharebuttonbox">
        <a href="#" class="bds_more" data-cmd="more"></a>
        <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
        <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
        <a href="#" class="bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
        <a href="#" class="bds_twi" data-cmd="twi" title="分享到Twitter"></a>
        <a href="#" class="bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
        <a href="#" class="bds_youdao" data-cmd="youdao" title="分享到有道云笔记"></a>
        <a href="#" class="bds_copy" data-cmd="copy" title="分享到复制网址"></a>
    </div>
    <script>
        window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"1","bdSize":"24"},"share":{}};
        with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
    </script>


        

    

	<!-- comment -->
    
<section id="comment">
  <h2 class="title">Comments</h2>

  
  	 <div class="ds-thread" data-thread-key="2016/09/16/python模块的打包与发布小结/" data-title="python模块的打包与发布小结" data-url="http://pytlab.github.io/2016/09/16/python模块的打包与发布小结/"></div>  
  
</section>

	</div> <!-- col-md-9/col-md-12 -->
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2016-09-16 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/学习小结/">学习小结<span class="badge">79</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/python/">python<span class="badge">43</span></a></li> <li><a href="/tags/setuptools/">setuptools<span class="badge">1</span></a></li>

    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
			<ol class="toc-article"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#前言"><span class="toc-article-text">前言</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#VASPy包文件结构"><span class="toc-article-text">VASPy包文件结构</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#打包和安装第三方包的工具"><span class="toc-article-text">打包和安装第三方包的工具</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#包中不同文件的作用"><span class="toc-article-text">包中不同文件的作用</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#setup-py"><span class="toc-article-text">setup.py</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#setup-cfg"><span class="toc-article-text">setup.cfg</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#README-rst"><span class="toc-article-text">README.rst</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#MANIFEST-in"><span class="toc-article-text">MANIFEST.in</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#vaspy"><span class="toc-article-text">vaspy/</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#tests"><span class="toc-article-text">tests/</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#setup-的参数"><span class="toc-article-text">setup()的参数</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#name"><span class="toc-article-text">name</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#version"><span class="toc-article-text">version</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#description"><span class="toc-article-text">description</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#long-description"><span class="toc-article-text">long_description</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#url"><span class="toc-article-text">url</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#packages"><span class="toc-article-text">packages</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#setup-requires"><span class="toc-article-text">setup_requires</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#classifier"><span class="toc-article-text">classifier</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#test-suite"><span class="toc-article-text">test_suite</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#发布自己的python包"><span class="toc-article-text">发布自己的python包</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#参考"><span class="toc-article-text">参考</span></a></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	</div>
		

</div><!-- row -->

<script type="text/javascript">
  var duoshuoQuery = { short_name: 'pytlab' };
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';
    ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; copyright 2017 by <a href="http://pytlab.github.io"> PytLab </a>
  
      &nbsp; <a href="http://github.com/PytLab/hexo-theme-freemind/">Theme</a> by <a href="http://pytlab.github.io/">PytLab</a> based on <a href="https://github.com/wzpan/hexo-theme-freemind/">Freemind</a>.
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->



</body>
   </html>
